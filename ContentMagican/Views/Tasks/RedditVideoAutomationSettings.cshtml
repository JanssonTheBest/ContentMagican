@model ContentMagican.Models.RedditVideoAutomationSettingsViewModel
@{
    ViewData["Title"] = "Video Automation Settings";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"]</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @foreach (var font in Model.fonts)
        {
            @Html.Raw($@"
                @font-face {{
                    font-family: '{font.Name}';
                    src: url('{font.Path}') format('truetype');
                    font-weight: normal;
                    font-style: normal;
                }}
            ")
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Reddit Story Video Automation Settings</h1>

        <form asp-action="CreateRedditVideoAutomationTask" method="post">
            <!-- Account to Publish On -->
            <div class="mb-3">
                <label for="accountToPublish" class="form-label">Account to Publish On</label>
                <select class="form-select" id="accountToPublish" name="AccountToPublish" required>
                    <option value="" disabled selected>Select an account</option>
                   @* Uncomment and populate with actual accounts in production *@
                   @* @foreach (var account in Model.accounts)
                    {
                        <option value="@account.Id">@account.Name</option>
                    } *@
                    <option value="addAccount">+ Add Account</option>
                </select>
                <small class="form-text text-muted">Choose an account to publish your videos.</small>
            </div>

            <!-- Remaining settings -->
            <fieldset id="settingsFieldset" disabled>
                <!-- Text Style Dropdown with Font Previews -->
                <div class="mb-3">
                    <label for="textStyle" class="form-label">Text Style</label>
                    <select class="form-select" id="textStyle" name="TextStyle" required>
                        <option value="" disabled selected>Select a font</option>
                        @foreach (var font in Model.fonts)
                        {
                            <option value="@font.Path" style="font-family: '@font.Name';">
                                @font.Name
                            </option>
                        }
                    </select>
                    <small class="form-text text-muted">Choose a font style for your text.</small>
                </div>

                <!-- Gameplay Video Choice Dropdown -->
                <div class="mb-3">
                    <label for="gameplayVideo" class="form-label">Gameplay Video</label>
                    <select class="form-select" id="gameplayVideo" name="GameplayVideo" required>
                        @foreach(var item in Model.video)
                        {
                            <option value="@item.Path">@item.Name</option>                        
                        }
                    </select>
                </div>

                <!-- Platform Choice Dropdown -->
                <div class="mb-3">
                    <label for="platform" class="form-label">Platform</label>
                    <select class="form-select" id="platform" name="Platform" required>
                        <option value="YouTube-Shorts">YouTube-Shorts</option>
                        <option value="Tiktok">Tiktok</option>
                        <option value="Instagram-Reels">Instagram-Reels</option>
                    </select>
                </div>

                <!-- Videos Per Day Dropdown -->
                <div class="mb-3">
                    <label for="videosPerDay" class="form-label">Videos Per Day</label>
                    <select class="form-select" id="videosPerDay" name="VideosPerDay" required>
                        <option value="1">1 video/day</option>
                        <option value="2">2 videos/day</option>
                        <option value="3">3 videos/day</option>
                        <option value="4">4 videos/day</option>
                        <option value="5">5 videos/day</option>
                    </select>
                    <small class="form-text text-muted">Select how many videos should be published each day.</small>
                </div>

                <!-- Video Title Input -->
                <div class="mb-3">
                    <label for="taskDescription" class="form-label">Task Description</label>
                    <input type="text" class="form-control" id="taskDescription" name="taskDescription" placeholder="Enter task description" required>
                </div>
            </fieldset>

            <!-- Submit Button -->
            <div class="d-flex justify-content-end mb-3">
                <button type="submit" class="btn btn-primary" id="nextButton" style="margin:5px; height:40px">
                    Next
                </button>
            </div>
        </form>
    </div>

    <!-- Bootstrap JS (Optional, for interactive components) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('accountToPublish').addEventListener('change', function() {
            const selectedValue = this.value;

            if (selectedValue === 'addAccount') {
                // Redirect to the specified action
                window.location.href = '@Url.Action("AppAuth", "Tiktok")';
            }

            // Enable/Disable the fieldset based on selection
            const fieldset = document.getElementById('settingsFieldset');
            if (selectedValue && selectedValue !== 'addAccount') {
                fieldset.removeAttribute('disabled');
            } else {
                fieldset.setAttribute('disabled', true);
            }
        });
    </script>
</body>
</html>
